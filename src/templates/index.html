{% extends "base.html" %}

{% block content %}
<div class="grid">
    <div class="card stat-card">
        <h3 class="stat-label">Blockchain Length</h3>
        <p class="stat-value">{{ chain|length }}</p>
    </div>
    <div class="card stat-card">
        <h3 class="stat-label">Pending Transactions</h3>
        <div style="display: flex; flex-direction: column; align-items: center; gap: 1rem;">
            <p class="stat-value">{{ pending_tx_count }}</p>
            {% if pending_tx_count > 0 %}
            <a href="/mine" class="btn">Mine Block</a>
            {% else %}
            <button class="btn btn-secondary" disabled>Nothing to Mine</button>
            {% endif %}
        </div>
    </div>
    <div class="card stat-card">
        <h3 class="stat-label">Network Peers</h3>
        <p class="stat-value">{{ peers_count }}</p>
    </div>
</div>

<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h2>Recent Blocks</h2>
        <a href="/sync" class="btn btn-secondary" style="font-size: 0.9rem;">Sync Chain</a>
    </div>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Height</th>
                    <th>Timestamp</th>
                    <th>Transactions</th>
                    <th>Validator</th>
                    <th>Previous Hash</th>
                </tr>
            </thead>
            <tbody>
                {% for block in chain|reverse %}
                <tr>
                    <td>#{{ block.index }}</td>
                    <td>{{ block.timestamp }}</td>
                    <td>{{ block.transactions|length }}</td>
                    <td>
                        <span class="badge badge-success">Authority {{ block.validator }}</span>
                    </td>
                    <td class="hash-text">{{ block.previous_hash[:20] }}...</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}